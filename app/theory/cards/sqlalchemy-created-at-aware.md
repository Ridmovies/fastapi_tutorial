```
# SQLAlchemy: default –¥–ª—è created_at –∏ aware datetime

–í SQLAlchemy –ø—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –ø–æ–ª–µ `created_at`.  
–í–∞–∂–Ω–æ –ø–æ–Ω–∏–º–∞—Ç—å —Ä–∞–∑–Ω–∏—Ü—É –º–µ–∂–¥—É Python-side default, —Å–µ—Ä–≤–µ—Ä–Ω—ã–º default –∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π timezone.

---

## 1Ô∏è‚É£ –ü–ª–æ—Ö–æ–π —Å—Ç–∏–ª—å (–Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º)

```python
created_at: Mapped[datetime] = mapped_column(default=datetime.now())
```

**–ü–æ—á–µ–º—É –ø–ª–æ—Ö–æ:**

- `datetime.now()` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–æ–¥–∏–Ω —Ä–∞–∑ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –º–æ–¥—É–ª—è**.
- –í—Å–µ –Ω–æ–≤—ã–µ —Å—Ç—Ä–æ–∫–∏ –±—É–¥—É—Ç –∏–º–µ—Ç—å **–æ–¥–Ω–æ –∏ —Ç–æ –∂–µ –≤—Ä–µ–º—è**, —Ä–∞–≤–Ω–æ–µ –º–æ–º–µ–Ω—Ç—É —Å—Ç–∞—Ä—Ç–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.
- –ù–µ —É—á–∏—Ç—ã–≤–∞–µ—Ç UTC –∏–ª–∏ —á–∞—Å–æ–≤–æ–π –ø–æ—è—Å.

---

## 2Ô∏è‚É£ Python-side default (lambda)

```python
from datetime import datetime, timezone

created_at: Mapped[datetime] = mapped_column(
    DateTime(timezone=True),
    default=lambda: datetime.now(timezone.utc)
)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- Lambda –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è **–∫–∞–∂–¥—ã–π —Ä–∞–∑**, –∫–æ–≥–¥–∞ —Å–æ–∑–¥–∞—ë—Ç—Å—è –Ω–æ–≤—ã–π –æ–±—ä–µ–∫—Ç –º–æ–¥–µ–ª–∏.
- –î–∞—ë—Ç **—Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è –≤ UTC**.
- –£–¥–æ–±–Ω–æ –¥–ª—è —Ç–µ—Å—Ç–æ–≤ –∏ –∫–æ–≥–¥–∞ –≤–∞–∂–Ω–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Ä–µ–º–µ–Ω–µ–º.

---

## 3Ô∏è‚É£ Database-side default (server_default)

```python
from sqlalchemy import func

created_at: Mapped[datetime] = mapped_column(
    DateTime(timezone=True),
    server_default=func.now(),
    nullable=False
)
```

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**

- –ó–Ω–∞—á–µ–Ω–∏–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è **–Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö**.
- –†–∞–±–æ—Ç–∞–µ—Ç —Å –ª—é–±—ã–º INSERT (ORM –∏ raw SQL).
- –ó–∞–≤–∏—Å–∏—Ç –æ—Ç **–Ω–∞—Å—Ç—Ä–æ–µ–∫ timezone –ë–î**.
- –ü–æ–¥—Ö–æ–¥–∏—Ç –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ –º–µ–∂–¥—É —Ä–∞–∑–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è–º–∏.

---

## 4Ô∏è‚É£ Lambda vs server_default

| –ü–∞—Ä–∞–º–µ—Ç—Ä | Lambda (Python) | server_default (DB) |
|-----------|----------------|-------------------|
| –ì–¥–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è | Python / ORM | –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö |
| Raw SQL –≤—Å—Ç–∞–≤–∫–∞ | –ù–µ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è | –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ |
| UTC | –Ø–≤–Ω–æ —á–µ—Ä–µ–∑ datetime.now(timezone.utc) | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç timezone –ë–î |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | –õ–µ–≥–∫–æ –º–æ–∫–∞—Ç—å –≤—Ä–µ–º—è | –°–ª–æ–∂–Ω–µ–µ –ø–æ–¥–º–µ–Ω–∏—Ç—å |
| Rollback / –º–∏–≥—Ä–∞—Ü–∏–∏ | –ü–æ–ª–Ω–æ—Å—Ç—å—é –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º–æ | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç SQL engine |

üí° –ß–∞—Å—Ç–æ –¥–µ–ª–∞—é—Ç **–æ–±–∞**: lambda –¥–ª—è ORM + server_default –¥–ª—è raw SQL.

---

## 5Ô∏è‚É£ –ß—Ç–æ —Ç–∞–∫–æ–µ aware datetime

- **Aware datetime** ‚Äî –æ–±—ä–µ–∫—Ç datetime —Å **–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ**.
- –û—Ç–ª–∏—á–∞–µ—Ç—Å—è –æ—Ç **naive datetime**, —É –∫–æ—Ç–æ—Ä–æ–≥–æ **–Ω–µ—Ç timezone**.
- –ü—Ä–∏–º–µ—Ä:

```python
from datetime import datetime, timezone

# aware datetime
dt_aware = datetime.now(timezone.utc)

# naive datetime
dt_naive = datetime.now()
```

- –í SQLAlchemy —Å `DateTime(timezone=True)` —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **aware datetime**, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –æ—à–∏–±–æ–∫ —Å —Ä–∞–∑–Ω—ã–º–∏ —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∏ –ë–î.

---

## 6Ô∏è‚É£ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

1. –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `default=datetime.now()`.
2. –î–ª—è ORM –≤—Å—Ç–∞–≤–æ–∫: `default=lambda: datetime.now(timezone.utc)`.
3. –î–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏ —Å raw SQL: `server_default=func.now()`.
4. –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ **aware datetime** –ø—Ä–∏ —Ö—Ä–∞–Ω–µ–Ω–∏–∏ –≤—Ä–µ–º–µ–Ω–∏ –≤ –ë–î.
5. –ú–æ–∂–Ω–æ –∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞—Ç—å –æ–±–∞ —Å–ø–æ—Å–æ–±–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç–∏.

```
